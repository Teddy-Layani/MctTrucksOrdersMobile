sap.ui.define(["com/meir/meirordersmobile/controller/BaseController"],function(e){"use strict";return e.extend("com.meir.meirordersmobile.controller.MOHome",{onInit:function(){this.fetchUserCardentails();this.getView().addEventDelegate({onBeforeShow:jQuery.proxy(function(e){this.onBeforeShow(e)},this)})},onBeforeShow:function(){this.getActivitySet()},onNewActivityButtonPress:function(){this.getRouter().navTo("MOCustomers")},onListItemPress:function(e){var t=e.getSource().data("activityDetails");var s=t.Guid;this.getView().setBusy(true);var i=this.getOwnerComponent().getModel();var r=this;var o="/ActivitySet(guid'"+s+"')";i.read(o,{success:function(e){var t=r.getOwnerComponent().getModel("moModel");t.setProperty("/MONewActivityDetails/currentActivityDetails",e);r.getView().setBusy(false);r.getRouter().navTo("MONewActivityDetails")},error:function(e){r.getView().setBusy(false)}})},fetchUserCardentails:function(){this.getView().setBusy(true);var e=this.getOwnerComponent().getModel();var t=this;e.read("/UserBPDataSet",{success:function(e){var s=t.getOwnerComponent().getModel("moModel");s.setProperty("/MOHome/UserBPDataSet",e.results);t.getView().setBusy(false)},error:function(e){t.getView().setBusy(false)}})},getActivitySet:function(){this.getView().setBusy(true);var e=this.getOwnerComponent().getModel();var t=this;e.read("/ActivitySet",{success:function(e){var s=t.getOwnerComponent().getModel("moModel");s.setProperty("/MOHome/ActivitySet",e.results);t.filterByDate();t.getView().setBusy(false)},error:function(e){t.getView().setBusy(false)}})},filterByDate:function(e){var t;if(e)t=e.getParameters().key;else t="nextDays";var s=[],i=new Date;switch(t){case"nextDays":s.push(new sap.ui.model.Filter("Date","GE",new Date));break;case"2DayAgo":i.setDate(i.getDate()-2);s.push(new sap.ui.model.Filter("Date","BT",i,new Date));break;case"weekAgo":i.setDate(i.getDate()-7);s.push(new sap.ui.model.Filter("Date","BT",i,new Date));break;case"2weeksAgo":i.setDate(i.getDate()-14);s.push(new sap.ui.model.Filter("Date","BT",i,new Date));break}var r=this.byId("callsList");var o=r.getBinding("items");o.filter(s)}})});